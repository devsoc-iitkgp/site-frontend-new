var Dt=Object.defineProperty;var ot=s=>{throw TypeError(s)};var Et=(s,e,t)=>e in s?Dt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var y=(s,e,t)=>Et(s,typeof e!="symbol"?e+"":e,t),Z=(s,e,t)=>e.has(s)||ot("Cannot "+t);var r=(s,e,t)=>(Z(s,e,"read from private field"),t?t.call(s):e.get(s)),w=(s,e,t)=>e.has(s)?ot("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),z=(s,e,t,i)=>(Z(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),d=(s,e,t)=>(Z(s,e,"access private method"),t);import{r as q,j as kt}from"./index-j7DW7U0N.js";import{S as dt,v as Bt,w as rt,x as It,y as ft,M as C,I as pt,z as ut,D as Ft,A as Nt,g as Ot,E as _t,n as M,o as Vt,d as Wt,W as jt,f as Ht,b as $,V as tt,F as Yt,G as Ut,H as Xt,C as ct,J as Tt,K as Gt}from"./three.module-Df1A5Gfx.js";class Zt extends dt{constructor(){super();const e=new Bt;e.deleteAttribute("uv");const t=new rt({side:It}),i=new rt,a=new ft(16777215,900,28,2);a.position.set(.418,16.199,.3),this.add(a);const f=new C(e,t);f.position.set(-.757,13.219,.717),f.scale.set(31.713,28.305,28.591),this.add(f);const c=new pt(e,i,6),n=new ut;n.position.set(-10.906,2.009,1.846),n.rotation.set(0,-.195,0),n.scale.set(2.328,7.905,4.651),n.updateMatrix(),c.setMatrixAt(0,n.matrix),n.position.set(-5.607,-.754,-.758),n.rotation.set(0,.994,0),n.scale.set(1.97,1.534,3.955),n.updateMatrix(),c.setMatrixAt(1,n.matrix),n.position.set(6.167,.857,7.803),n.rotation.set(0,.561,0),n.scale.set(3.927,6.285,3.687),n.updateMatrix(),c.setMatrixAt(2,n.matrix),n.position.set(-2.017,.018,6.124),n.rotation.set(0,.333,0),n.scale.set(2.002,4.566,2.064),n.updateMatrix(),c.setMatrixAt(3,n.matrix),n.position.set(2.291,-.756,-2.621),n.rotation.set(0,-.286,0),n.scale.set(1.546,1.552,1.496),n.updateMatrix(),c.setMatrixAt(4,n.matrix),n.position.set(-2.193,-.369,-5.547),n.rotation.set(0,.516,0),n.scale.set(3.875,3.487,2.986),n.updateMatrix(),c.setMatrixAt(5,n.matrix),this.add(c);const m=new C(e,k(50));m.position.set(-16.116,14.37,8.208),m.scale.set(.1,2.428,2.739),this.add(m);const l=new C(e,k(50));l.position.set(-16.109,18.021,-8.207),l.scale.set(.1,2.425,2.751),this.add(l);const h=new C(e,k(17));h.position.set(14.904,12.198,-1.832),h.scale.set(.15,4.265,6.331),this.add(h);const A=new C(e,k(43));A.position.set(-.462,8.89,14.52),A.scale.set(4.38,5.441,.088),this.add(A);const g=new C(e,k(20));g.position.set(3.235,11.486,-12.541),g.scale.set(2.5,2,.1),this.add(g);const x=new C(e,k(100));x.position.set(0,20,0),x.scale.set(1,.1,1),this.add(x)}dispose(){const e=new Set;this.traverse(t=>{t.isMesh&&(e.add(t.geometry),e.add(t.material))});for(const t of e)t.dispose()}}function k(s){return new Ft({color:0,emissive:16777215,emissiveIntensity:s})}var v,P,F,D,N,O,_,V,S,W,o,gt,yt,xt,vt,wt,Mt,et,U,At,it,zt,st,X,bt;class qt{constructor(e){w(this,o);w(this,v);y(this,"canvas");y(this,"camera");y(this,"cameraMinAspect");y(this,"cameraMaxAspect");y(this,"cameraFov");y(this,"maxPixelRatio");y(this,"minPixelRatio");y(this,"scene");y(this,"renderer");w(this,P);y(this,"size",{width:0,height:0,wWidth:0,wHeight:0,ratio:0,pixelRatio:0});y(this,"render",d(this,o,bt));y(this,"onBeforeRender",()=>{});y(this,"onAfterRender",()=>{});y(this,"onAfterResize",()=>{});w(this,F,!1);w(this,D,!1);y(this,"isDisposed",!1);w(this,N);w(this,O);w(this,_);w(this,V,new Vt);w(this,S,{elapsed:0,delta:0});w(this,W);z(this,v,{...e}),d(this,o,gt).call(this),d(this,o,yt).call(this),d(this,o,xt).call(this),this.resize(),d(this,o,vt).call(this)}resize(){let e,t;r(this,v).size instanceof Object?(e=r(this,v).size.width,t=r(this,v).size.height):r(this,v).size==="parent"&&this.canvas.parentNode?(e=this.canvas.parentNode.offsetWidth,t=this.canvas.parentNode.offsetHeight):(e=window.innerWidth,t=window.innerHeight),this.size.width=e,this.size.height=t,this.size.ratio=e/t,d(this,o,At).call(this),d(this,o,zt).call(this),this.onAfterResize(this.size)}updateWorldSize(){if(this.camera.isPerspectiveCamera){const e=this.camera.fov*Math.PI/180;this.size.wHeight=2*Math.tan(e/2)*this.camera.position.length(),this.size.wWidth=this.size.wHeight*this.camera.aspect}else this.camera.isOrthographicCamera&&(this.size.wHeight=this.camera.top-this.camera.bottom,this.size.wWidth=this.camera.right-this.camera.left)}get postprocessing(){return r(this,P)}set postprocessing(e){z(this,P,e),this.render=e.render.bind(e)}clear(){this.scene.traverse(e=>{e.isMesh&&typeof e.material=="object"&&e.material!==null&&(Object.keys(e.material).forEach(t=>{const i=e.material[t];i!==null&&typeof i=="object"&&typeof i.dispose=="function"&&i.dispose()}),e.material.dispose(),e.geometry.dispose())}),this.scene.clear()}dispose(){var e;d(this,o,wt).call(this),d(this,o,X).call(this),this.clear(),(e=r(this,P))==null||e.dispose(),this.renderer.dispose(),this.isDisposed=!0}}v=new WeakMap,P=new WeakMap,F=new WeakMap,D=new WeakMap,N=new WeakMap,O=new WeakMap,_=new WeakMap,V=new WeakMap,S=new WeakMap,W=new WeakMap,o=new WeakSet,gt=function(){this.camera=new Wt,this.cameraFov=this.camera.fov},yt=function(){this.scene=new dt},xt=function(){r(this,v).canvas?this.canvas=r(this,v).canvas:r(this,v).id?this.canvas=document.getElementById(r(this,v).id):console.error("Three: Missing canvas or id parameter"),this.canvas.style.display="block";const e={canvas:this.canvas,powerPreference:"high-performance",...r(this,v).rendererOptions??{}};this.renderer=new jt(e),this.renderer.outputColorSpace=Ht},vt=function(){r(this,v).size instanceof Object||(window.addEventListener("resize",d(this,o,U).bind(this)),r(this,v).size==="parent"&&this.canvas.parentNode&&(z(this,O,new ResizeObserver(d(this,o,U).bind(this))),r(this,O).observe(this.canvas.parentNode))),z(this,N,new IntersectionObserver(d(this,o,Mt).bind(this),{root:null,rootMargin:"0px",threshold:0})),r(this,N).observe(this.canvas),document.addEventListener("visibilitychange",d(this,o,et).bind(this))},wt=function(){var e,t;window.removeEventListener("resize",d(this,o,U).bind(this)),(e=r(this,O))==null||e.disconnect(),(t=r(this,N))==null||t.disconnect(),document.removeEventListener("visibilitychange",d(this,o,et).bind(this))},Mt=function(e){z(this,F,e[0].isIntersecting),r(this,F)?d(this,o,st).call(this):d(this,o,X).call(this)},et=function(){r(this,F)&&(document.hidden?d(this,o,X).call(this):d(this,o,st).call(this))},U=function(){r(this,_)&&clearTimeout(r(this,_)),z(this,_,setTimeout(this.resize.bind(this),100))},At=function(){this.camera.aspect=this.size.width/this.size.height,this.camera.isPerspectiveCamera&&this.cameraFov&&(this.cameraMinAspect&&this.camera.aspect<this.cameraMinAspect?d(this,o,it).call(this,this.cameraMinAspect):this.cameraMaxAspect&&this.camera.aspect>this.cameraMaxAspect?d(this,o,it).call(this,this.cameraMaxAspect):this.camera.fov=this.cameraFov),this.camera.updateProjectionMatrix(),this.updateWorldSize()},it=function(e){const t=Math.tan($.degToRad(this.cameraFov/2))/(this.camera.aspect/e);this.camera.fov=2*$.radToDeg(Math.atan(t))},zt=function(){var t;this.renderer.setSize(this.size.width,this.size.height),(t=r(this,P))==null||t.setSize(this.size.width,this.size.height);let e=window.devicePixelRatio;this.maxPixelRatio&&e>this.maxPixelRatio?e=this.maxPixelRatio:this.minPixelRatio&&e<this.minPixelRatio&&(e=this.minPixelRatio),this.renderer.setPixelRatio(e),this.size.pixelRatio=e},st=function(){if(r(this,D))return;const e=()=>{z(this,W,requestAnimationFrame(e)),r(this,S).delta=r(this,V).getDelta(),r(this,S).elapsed+=r(this,S).delta,this.onBeforeRender(r(this,S)),this.render(),this.onAfterRender(r(this,S))};z(this,D,!0),r(this,V).start(),e()},X=function(){r(this,D)&&(cancelAnimationFrame(r(this,W)),z(this,D,!1),r(this,V).stop())},bt=function(){this.renderer.render(this.scene,this.camera)};const L=new Map,E=new tt;let J=!1;function Jt(s){const e={position:new tt,nPosition:new tt,hover:!1,onEnter(){},onMove(){},onClick(){},onLeave(){},...s};return function(t,i){L.has(t)||(L.set(t,i),J||(document.body.addEventListener("pointermove",ht),document.body.addEventListener("pointerleave",lt),document.body.addEventListener("click",Kt),J=!0))}(s.domElement,e),e.dispose=()=>{const t=s.domElement;L.delete(t),L.size===0&&(document.body.removeEventListener("pointermove",ht),document.body.removeEventListener("pointerleave",lt),J=!1)},e}function ht(s){E.x=s.clientX,E.y=s.clientY;for(const[e,t]of L){const i=e.getBoundingClientRect();Rt(i)?(St(t,i),t.hover||(t.hover=!0,t.onEnter(t)),t.onMove(t)):t.hover&&(t.hover=!1,t.onLeave(t))}}function Kt(s){E.x=s.clientX,E.y=s.clientY;for(const[e,t]of L){const i=e.getBoundingClientRect();St(t,i),Rt(i)&&t.onClick(t)}}function lt(){for(const s of L.values())s.hover&&(s.hover=!1,s.onLeave(s))}function St(s,e){const{position:t,nPosition:i}=s;t.x=E.x-e.left,t.y=E.y-e.top,i.x=t.x/e.width*2-1,i.y=-t.y/e.height*2+1}function Rt(s){const{x:e,y:t}=E,{left:i,top:a,width:f,height:c}=s;return e>=i&&e<=i+f&&t>=a&&t<=a+c}const{randFloat:Qt,randFloatSpread:K}=$,Q=new M,p=new M,j=new M,$t=new M,u=new M,H=new M,B=new M,b=new M,Y=new M,mt=new M;var T,Ct;class te{constructor(e){w(this,T);this.config=e,this.positionData=new Float32Array(3*e.count).fill(0),this.velocityData=new Float32Array(3*e.count).fill(0),this.sizeData=new Float32Array(e.count).fill(1),this.center=new M,d(this,T,Ct).call(this),this.setSizes()}setSizes(){const{config:e,sizeData:t}=this;t[0]=e.size0;for(let i=1;i<e.count;i++)t[i]=Qt(e.minSize,e.maxSize)}update(e){const{config:t,center:i,positionData:a,sizeData:f,velocityData:c}=this;let n=0;t.controlSphere0&&(n=1,Q.fromArray(a,0),Q.lerp(i,.1).toArray(a,0),$t.set(0,0,0).toArray(c,0));for(let m=n;m<t.count;m++){const l=3*m;p.fromArray(a,l),u.fromArray(c,l),u.y-=e.delta*t.gravity*f[m],u.multiplyScalar(t.friction),u.clampLength(0,t.maxVelocity),p.add(u),p.toArray(a,l),u.toArray(c,l)}for(let m=n;m<t.count;m++){const l=3*m;p.fromArray(a,l),u.fromArray(c,l);const h=f[m];for(let g=m+1;g<t.count;g++){const x=3*g;j.fromArray(a,x),H.fromArray(c,x);const R=f[g];B.copy(j).sub(p);const nt=B.length(),at=h+R;if(nt<at){const Pt=at-nt;b.copy(B).normalize().multiplyScalar(.5*Pt),Y.copy(b).multiplyScalar(Math.max(u.length(),1)),mt.copy(b).multiplyScalar(Math.max(H.length(),1)),p.sub(b),u.sub(Y),p.toArray(a,l),u.toArray(c,l),j.add(b),H.add(mt),j.toArray(a,x),H.toArray(c,x)}}if(t.controlSphere0){B.copy(Q).sub(p);const g=B.length(),x=h+f[0];if(g<x){const R=x-g;b.copy(B.normalize()).multiplyScalar(R),Y.copy(b).multiplyScalar(Math.max(u.length(),2)),p.sub(b),u.sub(Y)}}Math.abs(p.x)+h>t.maxX&&(p.x=Math.sign(p.x)*(t.maxX-h),u.x=-u.x*t.wallBounce),t.gravity===0?Math.abs(p.y)+h>t.maxY&&(p.y=Math.sign(p.y)*(t.maxY-h),u.y=-u.y*t.wallBounce):p.y-h<-t.maxY&&(p.y=-t.maxY+h,u.y=-u.y*t.wallBounce);const A=Math.max(t.maxZ,t.maxSize);Math.abs(p.z)+h>A&&(p.z=Math.sign(p.z)*(t.maxZ-h),u.z=-u.z*t.wallBounce),p.toArray(a,l),u.toArray(c,l)}}}T=new WeakSet,Ct=function(){const{config:e,positionData:t}=this;this.center.toArray(t,0);for(let i=1;i<e.count;i++){const a=3*i;t[a]=K(2*e.maxX),t[a+1]=K(2*e.maxY),t[a+2]=K(2*e.maxZ)}};class ee extends Tt{constructor(e){super(e),this.uniforms={thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}},this.defines.USE_UV="",this.onBeforeCompile=t=>{Object.assign(t.uniforms,this.uniforms),t.fragmentShader=`
        uniform float thicknessPower;
        uniform float thicknessScale;
        uniform float thicknessDistortion;
        uniform float thicknessAmbient;
        uniform float thicknessAttenuation;
      `+t.fragmentShader,t.fragmentShader=t.fragmentShader.replace("void main() {",`
        void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, inout ReflectedLight reflectedLight) {
          vec3 scatteringHalf = normalize(directLight.direction + (geometryNormal * thicknessDistortion));
          float scatteringDot = pow(saturate(dot(geometryViewDir, -scatteringHalf)), thicknessPower) * thicknessScale;
          #ifdef USE_COLOR
            vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * vColor;
          #else
            vec3 scatteringIllu = (scatteringDot + thicknessAmbient) * diffuse;
          #endif
          reflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;
        }

        void main() {
      `);const i=Gt.lights_fragment_begin.replaceAll("RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );",`
          RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
          RE_Direct_Scattering(directLight, vUv, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, reflectedLight);
        `);t.fragmentShader=t.fragmentShader.replace("#include <lights_fragment_begin>",i),this.onBeforeCompile2&&this.onBeforeCompile2(t)}}}const ie={count:200,colors:[0,0,0],ambientColor:16777215,ambientIntensity:1,lightIntensity:200,materialParams:{metalness:.5,roughness:.5,clearcoat:1,clearcoatRoughness:.15},minSize:.5,maxSize:1,size0:1,gravity:.5,friction:.9975,wallBounce:.95,maxVelocity:.15,maxX:5,maxY:5,maxZ:2,controlSphere0:!1,followCursor:!0},I=new ut;var G,Lt;class se extends pt{constructor(t,i={}){const a={...ie,...i},f=new Zt,c=new Yt(t,.04).fromScene(f).texture,n=new Ut,m=new ee({envMap:c,...a.materialParams});m.envMapRotation.x=-Math.PI/2;super(n,m,a.count);w(this,G);this.config=a,this.physics=new te(a),d(this,G,Lt).call(this),this.setColors(a.colors)}setColors(t){if(Array.isArray(t)&&t.length>1){const i=function(a){let f,c;function n(m){f=m,c=[],f.forEach(l=>{c.push(new ct(l))})}return n(a),{setColors:n,getColorAt:function(m,l=new ct){const h=Math.max(0,Math.min(1,m))*(f.length-1),A=Math.floor(h),g=c[A];if(A>=f.length-1)return g.clone();const x=h-A,R=c[A+1];return l.r=g.r+x*(R.r-g.r),l.g=g.g+x*(R.g-g.g),l.b=g.b+x*(R.b-g.b),l}}}(t);for(let a=0;a<this.count;a++)this.setColorAt(a,i.getColorAt(a/this.count)),a===0&&this.light.color.copy(i.getColorAt(a/this.count));this.instanceColor.needsUpdate=!0}}update(t){this.physics.update(t);for(let i=0;i<this.count;i++)I.position.fromArray(this.physics.positionData,3*i),i===0&&this.config.followCursor===!1?I.scale.setScalar(0):I.scale.setScalar(this.physics.sizeData[i]),I.updateMatrix(),this.setMatrixAt(i,I.matrix),i===0&&this.light.position.copy(I.position);this.instanceMatrix.needsUpdate=!0}}G=new WeakSet,Lt=function(){this.ambientLight=new Xt(this.config.ambientColor,this.config.ambientIntensity),this.add(this.ambientLight),this.light=new ft(this.config.colors[0],this.config.lightIntensity),this.add(this.light)};function ne(s,e={}){const t=new qt({canvas:s,size:"parent",rendererOptions:{antialias:!0,alpha:!0}});let i;t.renderer.toneMapping=Nt,t.camera.position.set(0,0,20),t.camera.lookAt(0,0,0),t.cameraMaxAspect=1.5,t.resize(),l(e);const a=new Ot,f=new _t(new M(0,0,1),0),c=new M;let n=!1;const m=Jt({domElement:s,onMove(){a.setFromCamera(m.nPosition,t.camera),t.camera.getWorldDirection(f.normal),a.ray.intersectPlane(f,c),i.physics.center.copy(c),i.config.controlSphere0=!0},onLeave(){i.config.controlSphere0=!1}});function l(h){i&&(t.clear(),t.scene.remove(i)),i=new se(t.renderer,h),t.scene.add(i)}return t.onBeforeRender=h=>{n||i.update(h)},t.onAfterResize=h=>{i.config.maxX=h.wWidth/2,i.config.maxY=h.wHeight/2},{three:t,get spheres(){return i},setCount(h){l({...i.config,count:h})},togglePause(){n=!n},dispose(){m.dispose(),t.dispose()}}}const ce=({className:s="",followCursor:e=!0,...t})=>{const i=q.useRef(null),a=q.useRef(null);return q.useEffect(()=>{const f=i.current;if(f)return a.current=ne(f,{followCursor:e,...t}),()=>{a.current&&a.current.dispose()}},[]),kt.jsx("canvas",{className:s,ref:i,style:{width:"100%",height:"100%"}})};export{ce as B};
